# 🏗️ アプリケーション詳細設計 (Detailed Design)

こちらは、アプリケーションの構造やコンポーネントの責務、機能要件を定義する「作り方」に関するルールです。

## 1\. 全体設計

  - **基本構成**: .net6.0, WPF, Livet を使用したMVVMパターンを採用します。
  - **アーキテクチャ**: **View, ViewModel, Feature, Model** の4層に加え、通信処理を分離する **Adapter** 層を設けます。
  - **レイヤー間のルール**:
      - Model層とViewModel層は、互いを直接参照しません。
      - ViewModel層とModel層の連携は、必ずFeature層を介して行います。

## 2\. 各レイヤーの設計

  - **Model層**:
      - `〇〇Domain`クラスがデータの実体を管理します。
      - `〇〇Domain`内に、データ操作を行う`〇〇Store`、検証ルールを持つ`〇〇ValidationRule`、検証を実行する`Validator`を実装します。
  - **Feature層**:
      - `〇〇Repository`クラスを作成し、Model層の`Store`クラスの機能をラップしてViewModelに提供します。これにより、データアクセスのロジックを再利用可能にします。
  - **ViewModel層**:
      - ViewModelからView（UserControlやWindow）を直接操作する処理は実装しません。
  - **View層**:
      - UI要素を`MainWindow.xaml`に直接記述せず、機能単位で`UserControl`に分割します。
      - 複数のViewで利用するConverterは`CommonConverter`クラスに集約します。
  - **Adapter層**:
      - 外部との通信処理（HTTPリクエストなど）に関するすべてのロジックをこの層に実装します。

## 3\. 共通機能設計

  - **プロパティ変更通知**: ViewModelの基底クラスに、プロパティの値を設定しつつ`PropertyChanged`イベントを発行する共通の`SetProperty`関数を実装し、各ViewModelはこれを必ず使用します。
  - **多言語対応**:
      - 表示文字列はキーと共に`Language.xml`で管理します。
      - 画面右上に配置したコンボボックスで言語を選択すると、表示がリアルタイムで切り替わる機能を実装します。
  - **ダイアログ**:
      - 文字列の表示切れなどを防ぐため、ダイアログはコンテンツに応じてサイズが動的に変更されるように実装します。